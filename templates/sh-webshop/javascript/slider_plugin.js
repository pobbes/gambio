/* <?php
#   --------------------------------------------------------------
#   slider_plugin.js 2012-03-20 tb@gambio
#   Gambio GmbH
#   http://www.gambio.de
#   Copyright (c) 2011 Gambio GmbH
#   Released under the GNU General Public License (Version 2)
#   [http://www.gnu.org/licenses/gpl-2.0.html]
#   --------------------------------------------------------------
?>*/
/*<?php
if($GLOBALS['coo_debugger']->is_enabled('uncompressed_js') == false)
{
?>*/
eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('(3($){$.16.6=3(){9 e=$("#1t").1u(),v=Q(7.6[e].C),m=0,n,w,R,D=E,q;m=$("#h o").T("F").G;$("#h o").C((m)*v);$("#h").r((m/2)*v);$("#1v").U("V");4($(".j-k a").G>1){9 f=7.6[e].1w.s("t");17(f[0]){W"H":$(".j-k").8("H",7.6[e].x).8("18","");I;19:$(".j-k").8("H","").8("18",7.6[e].x);I}17(f[1]){W"y":$(".j-k").8("X","").8("y",7.6[e].x);I;W"1a":$(".j-k").8("X",7.6[e].x).8("y",7.6[e].x);$(".j-k").8("1x-1y","1a");I;19:$(".j-k").8("X",7.6[e].x).8("y","");I}$(".j-k a").8("1z","1A")}4(m>2&&7.1b.1c!="1d"){q=J(3(){K(1)},7.6[e].Y)}4(7.1b.1c!="1d"){$(z).A("1B",3(){4(7.6[e].Z==L){M(q)}});$(z).A("10",3(){4(7.6[e].Z==L){M(q)}});$(z).A("11",3(){4(D==E&&7.6[e].Z==L&&m>2){q=J(3(){4($("#5").G==0){K(1)}},7.6[e].Y)}});$("#N .j-k a").1C(3(){9 a=$("#h o").T("F"),1e=$(a[m/2]).S("1f").p("u").s("t");n=Q(1e[1]);9 b=$(z).p("u").s(\'t\');w=Q(b[1]);4(D==E&&n!=w){M(q);4(w>n){R=w-n}12{R=w-n}K(R)}1D E})}3 K(c){D=L;9 d=0;4(c>0){d=c}12{d=c*(-1)}$("#5").1E();$("#h").1F({r:v*(m/2+c)},{1G:7.6[e].1H/d,1I:\'1J\',1K:3(){9 a=[];1L(9 i=0;i<d;i++){4(c>0){$("#h o").1g($("#h o").S("F:1M-1h").1i());$("#h").r($("#h").r()-v)}12{$("#h o").1N($("#h o").S("F:1O-1h").1i());$("#h").r($("#h").r()+v)}}a=$("#h o").T("F");$("#N .j-k a").1P("V");9 b=$(a[m/2]).S("1f").p("u").s("t");n=Q(b[1]);$("#1Q"+n).U("V");D=E;q=J(3(){K(1)},7.6[e].Y)}})}}})(1j);(3($){$.16.1k=3(){9 g,O,P,l,B;$.1R(z,3(){9 f=z;$(f).A("1l",3(){M(g);4($("#5").G==0){9 c=$("<1m></1m>").p("u","5");$("1S").1g(c)}$(f).1T("10");$(f).A("10",3(e){O=e.1U;P=e.1V});9 d=$(f).p("u").s("t");l=d[1];4(l!=$("#5").p("1W")){4(B){B.1n()}B=$.1X({1Y:"1Z",21:"22.23?24=25",26:L,27:{"28":"29","2a":l},2b:3(a){9 b=$(f).p("u").s("t");4(b[1]==l&&$.1o(a)!=""&&$.1o(a.2c(/<2d \\/>/g,""))!=""){$("#5").U(l);$("#5").2e(a);$("#5").8("y",O);$("#5").8("H",P);4((O-$(13).r()+$("#5").C()+1p)>=$(1q).C()){$("#5").8("y",O-$("#5").C()-20)}4((P-$(13).2f()+$("#5").14()+1p)>=$(1q).14()){$("#5").8("H",P-$("#5").14()-20)}$("#5").2g()}}})}});$(f).A("11",3(){l=0;g=J(15,1r)});$("#5").1s("1l",3(){9 a=$(f).p("u").s("t");l=a[1];M(g)});$("#5").1s("11",3(){l=0;g=J(15,1r)});3 15(){4(l==0){4(B){B.1n()}$("#5").2h()}}})}})(1j);$(13).2i(3(){4($("#N").G==1){$("#N").6();$("#N 2j").1k()}});',62,144,'|||function|if|slider_flyover_container|slider_plugin|js_options|css|var||||||||jcarousel_image_box||jcarousel|control|actual_area_id|ul_children_length|big_image_nr|ul|attr|timeout|scrollLeft|split|_|id|li_width|prev_image_nr|control_margin|left|this|bind|request|width|active_animation|false|li|length|top|break|setTimeout|update_view|true|clearTimeout|jcarousel_box|mouse_pos_x|mouse_pos_y|parseInt|count_steps|find|children|addClass|jcarousel_control_a_active|case|right|slider_speed|stop_on_mouseover|mousemove|mouseleave|else|document|height|remove_container|fn|switch|bottom|default|center|global|style_edit_mode|edit|tmp_big_image_nr|img|append|child|detach|jQuery|slider_flyover_content|mouseenter|div|abort|trim|30|window|50|live|jcarousel_slider_id|val|slideImg_1|control_position|text|align|visibility|visible|mouseover|click|return|hide|animate|duration|animation_speed|easing|linear|complete|for|first|prepend|last|removeClass|slideImg_|each|body|unbind|pageX|pageY|class|ajax|type|POST||url|request_port|php|module|Slider|async|data|action|get_flyover_content|slider_image_area_id|success|replace|br|html|scrollTop|show|remove|ready|area'.split('|'),0,{}));
/*<?php
}
else
{
?>*/
(function($){
    $.fn.slider_plugin = function(){  
		
		var slider_id = $("#jcarousel_slider_id").val();
		var li_width = parseInt(js_options.slider_plugin[slider_id].width);
		var ul_children_length = 0;
		var big_image_nr;
		var prev_image_nr;
		var count_steps;
		var active_animation = false;
		var timeout;
		      
		ul_children_length = $("#jcarousel_image_box ul").children("li").length;
		$("#jcarousel_image_box ul").width((ul_children_length)*li_width);
		$("#jcarousel_image_box").scrollLeft((ul_children_length/2)*li_width);
                $("#slideImg_1").addClass("jcarousel_control_a_active");
		
		if($(".jcarousel-control a").length > 1){
			var control_pos = js_options.slider_plugin[slider_id].control_position.split("_");
			switch(control_pos[0]){
				case "top":
					$(".jcarousel-control").css("top", js_options.slider_plugin[slider_id].control_margin).css("bottom", "");
					break;
				default:
					$(".jcarousel-control").css("top", "").css("bottom", js_options.slider_plugin[slider_id].control_margin);
					break;
			}
			switch(control_pos[1]){
				case "left":
					$(".jcarousel-control").css("right", "").css("left", js_options.slider_plugin[slider_id].control_margin);
					break;
				case "center":
					$(".jcarousel-control").css("right", js_options.slider_plugin[slider_id].control_margin).css("left", js_options.slider_plugin[slider_id].control_margin);
					$(".jcarousel-control").css("text-align", "center");
					break;
				default:
					$(".jcarousel-control").css("right", js_options.slider_plugin[slider_id].control_margin).css("left", "");
					break;
			}
			$(".jcarousel-control a").css("visibility", "visible");
		}

		if(ul_children_length > 2 && js_options.global.style_edit_mode != "edit"){
			timeout = setTimeout(function(){ update_view(1); }, js_options.slider_plugin[slider_id].slider_speed);
		}
                
        if(js_options.global.style_edit_mode != "edit"){
            $(this).bind("mouseover", function(){
                if(js_options.slider_plugin[slider_id].stop_on_mouseover == true){
                    clearTimeout(timeout);
                }
            });

            $(this).bind("mousemove", function(){
                if(js_options.slider_plugin[slider_id].stop_on_mouseover == true){
                    clearTimeout(timeout);
                }
            });

            $(this).bind("mouseleave", function(){
                if(active_animation == false && js_options.slider_plugin[slider_id].stop_on_mouseover == true && ul_children_length > 2){
                    timeout = setTimeout(
                        function(){ 
                                if($("#slider_flyover_container").length == 0){
                                    update_view(1);
                                }
                        }, 
                        js_options.slider_plugin[slider_id].slider_speed);
                }
            });

            $("#jcarousel_box .jcarousel-control a").click(function(){
                var actual_children = $("#jcarousel_image_box ul").children("li");
                var tmp_big_image_nr = $(actual_children[ul_children_length/2]).find("img").attr("id").split("_");
                big_image_nr = parseInt(tmp_big_image_nr[1]);
                var tmp_prev_image_nr = $(this).attr("id").split('_'); 
                prev_image_nr = parseInt(tmp_prev_image_nr[1]);

                if(active_animation == false && big_image_nr != prev_image_nr)
                {
                    clearTimeout(timeout); 
                    if(prev_image_nr > big_image_nr){
                        count_steps = prev_image_nr - big_image_nr;
                    }else{
                        count_steps = prev_image_nr - big_image_nr;
                    }
                    update_view(count_steps);
                }
                return false;
            });
		}

		function update_view(steps){
			active_animation = true;
			var tmp_steps = 0;
			if(steps > 0){
				tmp_steps = steps;
			}else{
				tmp_steps = steps*(-1);
			}
			$("#slider_flyover_container").hide();
			
			$("#jcarousel_image_box").animate({
				scrollLeft: li_width*(ul_children_length/2+steps)
			},{
				duration: js_options.slider_plugin[slider_id].animation_speed/tmp_steps, 
				easing: 'linear', 
				complete: function(){
					var actual_children = [];
					for(var i = 0; i < tmp_steps; i++){
						if(steps > 0){
							$("#jcarousel_image_box ul").append($("#jcarousel_image_box ul").find("li:first-child").detach());
							$("#jcarousel_image_box").scrollLeft($("#jcarousel_image_box").scrollLeft()-li_width);
						}else{
							$("#jcarousel_image_box ul").prepend($("#jcarousel_image_box ul").find("li:last-child").detach());
							$("#jcarousel_image_box").scrollLeft($("#jcarousel_image_box").scrollLeft()+li_width);
						}
					}
					actual_children = $("#jcarousel_image_box ul").children("li");
					$("#jcarousel_box .jcarousel-control a").removeClass("jcarousel_control_a_active");
					var tmp_big_image_nr = $(actual_children[ul_children_length/2]).find("img").attr("id").split("_");
					big_image_nr = parseInt(tmp_big_image_nr[1]);
					$("#slideImg_"+big_image_nr).addClass("jcarousel_control_a_active");
					active_animation = false;
					timeout = setTimeout(function(){ update_view(1); }, js_options.slider_plugin[slider_id].slider_speed);
				}
			});
		}
	};  
})(jQuery);

(function($){
    
	$.fn.slider_flyover_content = function(){         
      
		var flyover_timeout;
		var mouse_pos_x;
		var mouse_pos_y;
		var actual_area_id;
		var request;
      
			$.each(this, function(){
			var self = this;

			$(self).bind("mouseenter", function(){
				clearTimeout(flyover_timeout);

				if($("#slider_flyover_container").length == 0){
					var slider_flyover_container = $("<div></div>").attr("id", "slider_flyover_container");
					$("body").append(slider_flyover_container);
				}

				$(self).unbind("mousemove");

				$(self).bind("mousemove", function(e){
					mouse_pos_x = e.pageX;
					mouse_pos_y = e.pageY;
				});

				var id = $(self).attr("id").split("_");
				actual_area_id = id[1];  

				if(actual_area_id != $("#slider_flyover_container").attr("class")){
					if(request){
						request.abort();
					}
					request = $.ajax({
						type: "POST",
						url: "request_port.php?module=Slider",
						async: true,
						data: {"action": "get_flyover_content", "slider_image_area_id": actual_area_id},
						success: function(response){
							var id = $(self).attr("id").split("_");
							if(id[1] == actual_area_id && $.trim(response) != "" && $.trim(response.replace(/<br \/>/g, "")) != ""){
								$("#slider_flyover_container").addClass(actual_area_id);
								$("#slider_flyover_container").html(response);
								$("#slider_flyover_container").css("left", mouse_pos_x);
								$("#slider_flyover_container").css("top", mouse_pos_y);
								if((mouse_pos_x-$(document).scrollLeft() + $("#slider_flyover_container").width()+30) >= $(window).width()){
									$("#slider_flyover_container").css("left", mouse_pos_x-$("#slider_flyover_container").width()-20);
								}
								if((mouse_pos_y-$(document).scrollTop() + $("#slider_flyover_container").height()+30) >= $(window).height()){
									$("#slider_flyover_container").css("top", mouse_pos_y-$("#slider_flyover_container").height()-20);
								}
								$("#slider_flyover_container").show();
							}
						}
					});
				}
			});

			$(self).bind("mouseleave", function(){
				actual_area_id = 0;
				flyover_timeout = setTimeout(remove_container, 50);
			});

			$("#slider_flyover_container").live("mouseenter", function(){
				var id = $(self).attr("id").split("_");
				actual_area_id = id[1];
				clearTimeout(flyover_timeout);
			});

			$("#slider_flyover_container").live("mouseleave", function(){
				actual_area_id = 0;
				flyover_timeout = setTimeout(remove_container, 50);        
			});

			function remove_container(){
				if(actual_area_id == 0){
					if(request){
						request.abort();
					}
					$("#slider_flyover_container").remove();
				}
			}
		});
	};  
})(jQuery);

$(document).ready(function()
{
	if($("#jcarousel_box").length == 1){
		$("#jcarousel_box").slider_plugin();
		$("#jcarousel_box area").slider_flyover_content();
	}
});

/*<?php
}
?>*/
